<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Spotify – Strategic Product Thinking (Week 2)</title>

<script src="https://cdn.tailwindcss.com"></script>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

<style>
body { font-family: system-ui, -apple-system; background:#f8fafc; }
</style>
</head>

<body>
<div id="root"></div>

<script>
const h = React.createElement;
const { useState } = React;

/* ================= ERROR BOUNDARY ================= */
class ErrorBoundary extends React.Component {
  constructor(props){ super(props); this.state={hasError:false}; }
  static getDerivedStateFromError(){ return {hasError:true}; }
  render(){
    if(this.state.hasError){
      return h("div",{className:"min-h-screen flex items-center justify-center p-6"},
        h("div",{className:"bg-white p-8 rounded-xl shadow max-w-md text-center"},
          h("h2",{className:"text-2xl font-bold text-red-600 mb-3"},"Something went wrong"),
          h("p",{className:"text-gray-600"},"Please refresh the page.")
        )
      );
    }
    return this.props.children;
  }
}

/* ================= TRACKING ================= */
const GOOGLE_SCRIPT_URL =
"https://script.google.com/macros/s/AKfycbyGQtLE7KUZZZQ7xV_hlQCWzYayRKx2JnbTwtsQPRdmEFPaisrfm6qq3djx7QCpYTzi/exec";

function track(data){
  try{
    fetch(GOOGLE_SCRIPT_URL,{
      method:"POST",
      mode:"no-cors",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify(data)
    });
  }catch(e){}
}

/* ================= QUESTIONS ================= */
const QUESTIONS = [
["2006 – Piracy dominates","How should Spotify position itself?",
 ["Compete with iTunes",3,"Against labels"],
 ["Be better than piracy",10,"Aligns all incentives"],
 ["Netflix for music",6,"Analogy only"],
 ["Digital radio",4,"Understates disruption"]],
["2008 – Freemium pressure","What should Spotify do?",
 ["Kill free tier",2,"Kills growth"],
 ["Double down on freemium",10,"Builds habit & data"],
 ["Usage limits",5,"Resentment"],
 ["Lower price",4,"Value erosion"]],
["2011 – US entry","Biggest risk?",
 ["Tech scale",4,"Solvable"],
 ["Label negotiations",10,"Existential"],
 ["UX",3,"Not decisive"],
 ["Marketing",5,"Manageable"]],
["2015 – Apple Music","Where to compete?",
 ["Price",3,"Apple subsidizes"],
 ["Personalization",10,"Compounding moat"],
 ["Feature parity",6,"Copyable"],
 ["Exclusives",5,"Limited"]],
["2017 – Wrapped","Invest?",
 ["No",2,"Misses brand"],
 ["Yes – signature moment",10,"Earned media"],
 ["Small test",6,"Under-invest"],
 ["Quarterly",4,"Kills anticipation"]],
["2019 – Podcasts","Why invest?",
 ["Trend",3,"Weak"],
 ["Margins & ownership",10,"Fixes economics"],
 ["Replace music",2,"Impossible"],
 ["Marketing",5,"Secondary"]],
["2020 – Artists","Best response?",
 ["Raise payouts",2,"Unsustainable"],
 ["Discovery tools",10,"Career value"],
 ["Ignore",1,"Reputation risk"],
 ["Charge artists",3,"Bad optics"]],
["2023 – AI","Best bet?",
 ["AI music creation",3,"Threatens labels"],
 ["AI DJ",10,"Enhances moat"],
 ["Voice cloning",6,"Narrow"],
 ["Replace artists",1,"Suicide"]],
["2024 – Margins","Best lever?",
 ["Raise prices",4,"Short term"],
 ["Shift to podcasts",10,"Structural"],
 ["Cut R&D",3,"Harms moat"],
 ["Cut marketing",2,"Slows growth"]],
["2025 – Plateau","Next direction?",
 ["Music-only",2,"Caps upside"],
 ["Everything-audio",10,"Expands value"],
 ["Social network",5,"Crowded"],
 ["Live events",6,"Operational risk"]]
];

/* ================= APP ================= */
function App(){
  const [started,setStarted]=useState(false);
  const [email,setEmail]=useState("");
  const [i,setI]=useState(0);
  const [answers,setAnswers]=useState([]);
  const [feedback,setFeedback]=useState(null);

  if(!started){
    return h("div",{className:"min-h-screen flex items-center justify-center p-6"},
      h("div",{className:"bg-white p-8 rounded-xl shadow max-w-lg w-full"},
        h("h1",{className:"text-2xl font-bold mb-4"},"Spotify – Strategic Product Thinking"),
        h("input",{className:"border p-3 w-full mb-4",placeholder:"Your email",
          value:email,onChange:e=>setEmail(e.target.value)}),
        h("button",{className:"w-full bg-blue-600 text-white py-3 rounded",
          onClick:()=>{
            track({email,status:"started"});
            setStarted(true);
          }},"Start Simulation")
      )
    );
  }

  if(i >= QUESTIONS.length){
    const total = answers.reduce((s,a)=>s+a.points,0);
    const pct = Math.round(total / (QUESTIONS.length*10) * 100);
    return h("div",{className:"min-h-screen p-6 max-w-4xl mx-auto"},
      h("h2",{className:"text-3xl font-bold mb-4"},"Final Score: "+pct+"%"),
      h("table",{className:"w-full bg-white shadow rounded"},
        h("thead",null,h("tr",{className:"bg-gray-100"},
          ["Q","Choice","Score"].map(x=>h("th",{className:"p-3 text-left"},x)))),
        h("tbody",null,
          answers.map((a,idx)=>
            h("tr",{key:idx,className:"border-t"},
              h("td",{className:"p-3"},idx+1),
              h("td",{className:"p-3"},a.text),
              h("td",{className:"p-3"},a.points+"/10")
            )
          )
        )
      )
    );
  }

  const q = QUESTIONS[i];

  if(feedback){
    return h("div",{className:"min-h-screen flex items-center justify-center p-6"},
      h("div",{className:"bg-white p-8 rounded-xl shadow max-w-xl"},
        h("h3",{className:"font-bold mb-3"},"Feedback"),
        h("p",{className:"mb-4"},feedback.explain),
        h("button",{className:"bg-blue-600 text-white py-3 px-6 rounded",
          onClick:()=>{
            setAnswers([...answers,feedback]);
            setFeedback(null);
            setI(i+1);
          }},"Continue")
      )
    );
  }

  return h("div",{className:"min-h-screen flex items-center justify-center p-6"},
    h("div",{className:"bg-white p-8 rounded-xl shadow max-w-xl"},
      h("p",{className:"text-gray-600 mb-2"},q[0]),
      h("h3",{className:"font-semibold mb-4"},q[1]),
      q.slice(2).map((o,idx)=>
        h("button",{key:idx,className:"block w-full border p-4 rounded mb-3 hover:bg-blue-50",
          onClick:()=>setFeedback({text:o[0],points:o[1],explain:o[2]})},o[0])
      )
    )
  );
}

/* ================= RENDER ================= */
ReactDOM.createRoot(document.getElementById("root"))
  .render(h(ErrorBoundary,null,h(App)));
</script>
</body>
</html>
